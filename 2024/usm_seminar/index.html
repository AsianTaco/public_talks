<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>Robust cosmic field-level inference</title>
    <meta name="description" content="Talk at USM about robust cosmic field-level inference using PineTree and Robin-PiP">
    <meta name="author" content="Simon Ding">

    <link rel="stylesheet" href="reveal.js/dist/reset.css">
    <link rel="stylesheet" href="reveal.js/dist/reveal.css">
    <link rel="stylesheet" href="reveal.js/dist/theme/black.css">

    <!-- Theme used for syntax highlighted code -->
    <link rel="stylesheet" href="reveal.js/plugin/highlight/monokai.css">

    <style>
        .fancy_img {
            box-shadow: rgba(0, 0, 0, 0.25) 1.95px 1.95px 2.6px;
            border-radius: 7px;
        }
    </style>
</head>
<body>
<div class="reveal">
    <div class="slides">
        <section data-background-image="assets/euclid_mock.png"
                 data-background-size="1200 700"
                 style="position: relative"
                 data-transition="none"
                 data-background-transition="none">
            <div style="background-color: white; position: relative; right: 200px; top: 600px; width: 1600px; height: 200px; display: flex; justify-content: center">
                <img src="assets/EC_logos_official_Blue_with_text.png"
                     style="display:inline; height: 80px; padding: 0px 5px 0px 5px;">
                <img src="assets/iap.png" style="display: inline; height: 80px; padding: 0px 5px 0px 5px;">
                <img src="assets/aquila.jpg" style="display: inline; height: 80px; padding: 0px 5px 0px 5px;">
                <img src="assets/sorbonne_logo.png" style="display: inline; height: 80px; padding: 0px 5px 0px 5px;">
                <img src="assets/stockholm-university.png"
                     style="display: inline; height: 80px; padding: 0px 5px 0px 5px;">
            </div>
            <div data-transition="none" style="position: relative; bottom:100px">
                <div style="border-radius: 15px 80px; background: rgba(221,239,239,0.8); text-align: center">
                    <h2 style="color: black">Towards robust cosmic <br> field-level inference</h2>
                    <h4 style="color: black">through physics-informed modelling and priors</h4>
                    <p style="font-size: 80%; color: black">USM Galaxies and Lensing Seminar, Munich, 02.08.2024</p>
                </div>
                <div data-transition="none" style="padding: 10px"></div>
                <div data-transition="none"
                     style="border-radius: 15px; background: rgba(221,239,239,0.8); text-align: center">
                    <p style="color: black"><b>Simon Ding, PhD student @ IAP, France</b></p>
                    <p style="font-size:70%; color: black">supervised by <b>Guilhem Lavaux (IAP) & Jens Jasche (Stockholm
                        University)</b>
                    </p>
                </div>
            </div>
        </section>
        <section>
            <section>
                <div style="display: flex; align-items: center">
                    <img class="fancy_img" src="assets/Planck_history_of_Universe_zoom.jpg" height="600">
                    <div style="text-align: left; position: relative; left: 30px">
                        <p style="width: 500px; color: #FFD369FF">Understand the nature <br> of our universe</p>
                        <p class="fragment">&bull; Observe celestial objects <br>&nbsp;&nbsp; around us
                            (<span style="color: #FFD369FF"><b>Data</b></span>)
                        </p>
                        <p class="fragment">&bull; Compare against our <br>&nbsp;&nbsp; theoretical predictions
                            <br>&nbsp;&nbsp; (<span style="color: #FFD369FF"><b>Modelling</b> & <b>Inference</b></span>)
                        </p>
                    </div>
                    <aside class="notes">
                        <p>dynamics (past, present, future), inflation, what is dark energy, comsic content
                            (what is dark matter) etc. </p>
                        <p>Physics model also includes systematics, light-cones, masking etc.</p>
                    </aside>
                </div>
            </section>
            <section class="r-stack">
                <div style="position: relative; right: 100px; top: 20px">
                    <img class="fancy_img" src="assets/sdss.jpg" width="600px" style="display: inline; vertical-align: middle">
                    <div class="fragment" style="display: inline"> &nbsp; &xrarr; &nbsp; Compress: $P(k)$</div>
                </div>
                <img class="fragment fancy_img" style="position: relative; bottom: 550px; left: 363px" src="assets/sdss_pk.gif" height="500px">
            </section>
            <section>
                <p>Compression will <b>reduce</b> information content</p>
                <div style="display: flex; align-items: center">
                    <img class="fragment" src="assets/low_res_quijote_dm.svg" height="373">
                    <div>&nbsp;&nbsp;</div>
                    <img class="fragment" src="assets/random_field.svg" height="373">
                    <div>&nbsp;&nbsp;</div>
                    <img class="fragment" src="assets/pk_fields.svg" height="373">
                </div>
                <p class="fragment">&rArr; Switch to field-level approach</p>
            </section>
            <section data-transition="none" data-background-transition="none">
                <h4>Field-Level inference from Galaxy surveys with BORG</h4>
                <div data-transition="none" class="r-stack" style="position: relative">
                    <div class="fragment fade-out" data-fragment-index="1"
                         style="background-color: white; width:292px;height:305px; position: relative; right: -423px; bottom: 11px"></div>
                    <div class="fragment fade-out" data-fragment-index="2"
                         style="background-color: white; width:230px;height:300px; position: relative; right: 454px; bottom: 12px"></div>
                    <div class="fragment fade-out" data-fragment-index="3"
                         style="background-color: white; width:205px;height:303px; position: relative; right: 255px; bottom: 15px"></div>
                    <div class="fragment fade-out" data-fragment-index="4"
                         style="background-color: white; width:207px;height:311px; position: relative; right: 50px; bottom: 13px"></div>
                    <div class="fragment fade-out" data-fragment-index="5"
                         style="background-color: white; width:208px;height:311px; position: relative; left: 171px; bottom: 16px"></div>
                    <div class="fragment fade-out" data-fragment-index="6"
                         style="background-color: white; width:30px;height:30px; position: relative; right:40px; bottom: 177px"></div>
                    <div class="fragment fade-out" data-fragment-index="6"
                         style="background-color: white; width:30px;height:30px; position: relative; right:455px; bottom: 176px"></div>
                    <div class="fragment fade-out" data-fragment-index="6"
                         style="background-color: white; width:730px;height:104px; position: relative; right:180px; bottom: 217px"></div>

                    <div class="fragment fade-out" data-fragment-index="7"
                         style="background-color: white; width:398px;height:90px; position: relative; left:369px; bottom: 207px"></div>
                    <div>
                        <img class="fancy_img" src="assets/borg.png">
                        <div style="display: flex; align-items: center; font-size:50%; padding-top: 2em">
                            <div
                                    style="display: inline; width: 800px; text-align: left">
                                Jasche & Wandelt (2013),
                                Jasche, Leclercq & Wandelt (2015),<br>
                                Lavaux & Jasche (2016),
                                Jasche & Lavaux (2019)
                            </div>
                            <div
                                    style="display: inline; position: relative; left: 100px">Image credit: D.K Ramanah
                            </div>
                        </div>
                    </div>
                    <p class="fragment" data-fragment-index="9"
                       style="color: #FFD369; position: relative; top: 200px; right: 340px; font-size: 80%">
                        $\approx 2.1\times 10^6$ parameters
                    </p>
                </div>
            </section>
            <section>
                <video data-autoplay width="1300">
                    <source src="assets/Borg_2mpp.webm" type="video/webm" />
                </video>
                <div style="display: flex; align-items: center; font-size:50%; padding-top: 2em">
                    <div
                            style="display: inline; width: 800px; text-align: left; position: relative; left: 40px">
                        Jasche & Lavaux (2019)
                    </div>
                </div>
            </section>
            <section>
                <img src="assets/Sdss_wedge_density_velocity.png" height="620">
                <div style="display: flex; align-items: center; font-size:50%; padding-top: 2em; position: relative; bottom: 70px; left: 40px">
                    <div
                            style="display: inline; width: 800px; text-align: left">
                        Leclercq et al. (2017)
                    </div>
                    <div
                            style="display: inline; position: relative; left: 100px">Image credit: G. Lavaux
                    </div>
                </div>
            </section>
            <section data-auto-animate>
                <p style="text-align: left">New (big) data sets are coming in through e.g. Euclid, DESI,
                    LSST, ...</p>
                <p class="fragment" style="text-align: left"><b>Challenge:</b> Accurate and efficient data modelling</p>
                <ul>
                    <li class="fragment">Non-trivial dynamics on small scales</li>
                    <li class="fragment">Maintain computational performance on large survey volumes</li>
                    <li class="fragment">New (unknown) systematics</li>
                    <li class="fragment">...</li>
                </ul>
            </section>
            <section data-auto-animate>
                <p style="text-align: left">New (big) data sets are coming in through e.g. Euclid, DESI,
                    LSST, ...</p>
                <p style="text-align: left"><b>Challenge:</b> How to incorporate more flexible models? <br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    e.g. higher-order terms in EFT, neural networks, ...</p>
                <p style="padding-top: 1em" class="fragment">We only have one Universe!<br>
                    &rarr; Data unable to constrain both physics and nuisance parameters
                </p>
            </section>
            <section data-auto-animate data-transition="fade-in fade-out">
                <p style="padding-bottom: 1.2em">Possible solutions:</p>
                <ol type="1" style="padding-bottom: 3.8em">
                    <li class="fragment">Models with reduce parameter space</li>
                    <li class="fragment">Use better (behaved) priors $P(\theta)$</li>
                </ol>
            </section>
        </section>
        <section>
            <section data-transition="none" data-background-transition="none">
                <h4>Field-Level inference from Galaxy surveys with BORG</h4>
                <div data-transition="none" class="r-stack" style="position: relative">
                    <div>
                        <img class="fancy_img" src="assets/borg.png">
                        <div style="display: flex; align-items: center; font-size:50%; padding-top: 2em">
                            <div
                                    style="display: inline; width: 800px; text-align: left">
                                Jasche & Wandelt (2013),
                                Jasche, Leclercq & Wandelt (2015),<br>
                                Lavaux & Jasche (2016),
                                Jasche & Lavaux (2019)
                            </div>
                            <div
                                    style="display: inline; position: relative; left: 100px">Image credit: D.K Ramanah
                            </div>
                        </div>
                    </div>
                    <p class="fragment"
                       style="color: black; transform: rotate(-20deg); background-color: #e7e7e7; border-radius: 5px; position: relative; right: 160px; bottom: 42px">
                        &nbsp;Bias model&nbsp;</p>
                    <p class="fragment"
                       style="color: #FFD369; position: relative; top: 197px; right: 135px; font-size: 80%">
                        $\delta_m(x) \rightarrow n\big(M|\delta_m(x)\big)$
                    </p>
                </div>
            </section>
        </section>
        <section>
            <section>
                <p style="font-size: 190%; color: rgba(60,109,86,0.69)">$\texttt{PineTree}$</p>
                <p>(<b>P</b>hysical and <b>I</b>nterpretable <b>NE</b>tworks for <b>TR</b>ac<b>E</b>r <b>E</b>mulation)</p>
                <p style="font-size: 70%">Ding, Lavaux, Jasche 2024;
                    <a href="https://arxiv.org/abs/2407.01391">ArXiv: 2407.01391</a></p>
            </section>
            <section>
                <h3>A physics-informed neural bias model</h3>
                <div style="position: relative;">
                    <div class="fragment" data-fragment-index="0"
                         style="background-color: rgba(60,109,86,0.60); width: 330px; border-radius: 15px; display: inline-block; vertical-align: middle">
                        <b>dark matter <br> over-density field</b>
                    </div>
                    <div class="fragment" data-fragment-index="1"
                         style="font-size:1em; display: inline-block; vertical-align: middle"><b>&xrarr;</b></div>
                    <div class="fragment" data-fragment-index="1"
                         style="background-color: rgba(60,109,86,0.60); border-radius: 15px; width: 400px; display: inline-block; vertical-align: middle">
                        <b>machine learning</b> <br>
                        + <br>
                        <b>physical contraints</b>
                    </div>
                    <div class="fragment" data-fragment-index="2"
                         style="font-size:1em; display: inline-block; vertical-align: middle"><b>&xrarr;</b></div>
                    <div class="fragment" data-fragment-index="2"
                         style="background-color: rgba(60,109,86,0.60); border-radius: 15px; width: 300px; display: inline-block; vertical-align: middle">
                        <b>$N$-body-like <br> halo catalogues</b>
                    </div>
                </div>
                <div style="position: relative;">
                    <div class="fragment" data-fragment-index="0"
                         style="display: inline-block; vertical-align: middle; width: 330px; text-align: left">
                        <p style="font-size: 90%">From approximate gravity solvers <br> i.e. 2LPT, COLA (Tassev et al. 2013)</p>
                    </div>
                    <div style="font-size:1em; display: inline-block; vertical-align: middle"><b
                            style="visibility: hidden">&xrarr;</b>
                    </div>
                    <div class="fragment" data-fragment-index="1"
                         style="width: 400px; display: inline-block; vertical-align: middle">
                        <p>
                        <ul style="font-size: 90%">
                            <li>fast (GPU support)</li>
                            <li>differentiable</li>
                            <li>Stochastic</li>
                            <li>Explainable</li>
                            <li>17-32 parameters</li>
                        </ul>
                        </p>
                    </div>
                    <div style="font-size:1em; display: inline-block; vertical-align: middle"><b
                            style="visibility: hidden">&xrarr;</b>
                    </div>
                    <div class="fragment" data-fragment-index="2"
                         style="text-align: left; width: 300px; display: inline-block; vertical-align: middle">
                        <p>Validated via:</p>
                        <ul style="font-size: 90%">
                            <li>Halo mass function</li>
                            <li>Power spectrum</li>
                            <li>Bispectrum</li>
                        </ul>
                    </div>
                </div>
            </section>
            <section>
                <h4 class="fragment" data-fragment-index="10">Likelihood assumption</h4>
                <div class="r-stack">
                    <div style="background-color: white; border-radius: 25px">
                        <div class="fragment" data-fragment-index="1"
                             style="text-align: left; font-size: 80%; transform: rotate(-15deg)">
                            <span style="position: relative; left: 210px; color: black">
                            <span class="fragment" data-fragment-index="2">&bullet; Use non-local information</span><br>
                            <span class="fragment" data-fragment-index="5">&bullet; Use isotropy</span>
                            </span>
                        </div>
                        <div class="fragment" data-fragment-index="6"
                             style="font-size: 80%; position: relative; left:55px; transform: rotate(-15deg); color: black">
                            &bullet; Model non-linearity
                        </div>
                        <div class="fragment" data-fragment-index="8"
                             style="font-size: 80%; position: relative; bottom: 50px; left:380px; transform: rotate(-15deg); color: black">
                            &bullet; Generative process
                        </div>
                        <p style="color: black">
                    <span><img class="fragment" data-fragment-index="0" src="assets/density.png" height="200"
                               style="display: inline; padding-right: 20pt;
                             vertical-align: middle"> <span class="fragment" data-fragment-index="2">&rArr;</span>
                        <img class="fragment" data-fragment-index="4" src="assets/monopole_kernel.png"
                             height="200"
                             style="display: inline; vertical-align: middle"></span>
                            <span class="fragment" data-fragment-index="7">&rArr;<img src="assets/mdn.png" height="200"
                                                                                      style="display: inline; vertical-align: middle"></span>
                            <span class="fragment" data-fragment-index="9">&rArr;<img src="assets/sampling.png"
                                                                                      width="300"
                                                                                      style="display: inline; vertical-align: middle"></span>
                        </p>
                        <p style="color: black"><span class="fragment highlight-current-red" data-fragment-index="0"
                                 style="position: relative; right: 50px">$\delta_m(x)$ &rarr; </span>
                            <span class="fragment" data-fragment-index="4" style="position: relative; right: 23px"><b>Convolve</b> &rarr;</span>
                            <span class="fragment" data-fragment-index="7"><b>Transform</b> &rarr;</span>
                            <span class="fragment" data-fragment-index="9" style="position: relative; left: 20px"><b>Sample</b> &rarr;</span>
                            <span class="fragment highlight-current-red" data-fragment-index="1"
                                  style="position: relative; left: 55px">$n\big(M|\delta_m(x)\big)$</span>
                        </p>
                    </div>
                    <img class="fragment current-visible" data-fragment-index="5"
                         style="position: relative; right: 232px; top: 50px" src="assets/multipole_evol.gif"
                         width="400">
                </div>
            </section>
            <section>
                <p style="font-size: 1.2em; text-align: left"><b>Benchmark model as mock generator</b></p>
                <ul>
                    <li class="fragment">Optimize using <b>Poisson likelihood</b></li>
                    <li class="fragment">10 halo catalogues at $z=/{0, 1/}$ from <b>L-Gadget</b> + <b>rockstar</b></li>
                    <li class="fragment">Corresponding <b>2LPT</b> over-density fields</li>
                    <li class="fragment">$L = 500h^{-1}\,\rm{Mpc}$</li>
                    <li class="fragment">$M_{\rm{vir}} > 2 \times 10^{12}\,M_{\odot}$</li>
                    <li class="fragment">Validate on <b>unseen</b> simulations</li>
                </ul>
            </section>
            <section>
                <img class="fancy_img" src="assets/best_fit_overfiew.png" width="1896">
            </section>
            <section>
                <img class="fancy_img" src="assets/conditional_hmf.png" height="650">
            </section>
            <section>
                <img class="fancy_img" src="assets/cross-correlation.png" height="650">
            </section>
            <section>
                <b style="font-size: 120%">On model interpretability</b>
            </section>
            <section>
                <img class="fancy_img" src="assets/kernel_weights.svg" width="1200">
            </section>
            <section>
                <p>With SPH smoothing instead of CIC</p>
                <img class="fancy_img" src="assets/sph_kernel.svg" height="550">
            </section>
            <section>
                <h3 style="padding-bottom: 1em">Intermediate Summary</h3>
                <p class="fragment" style="text-align: left">&bull; <b>Generative model</b> for <b>LARGE</b>
                    (Euclid-like) volumes</p>
                <p class="fragment" style="text-align: left">&bull; Differentiable & fast ( ~10min for $3\,h^{-1}\,\mathrm{Gpc}$ box)</p>
                <p class="fragment" style="text-align: left">&bull; Robust & interpretable model</p>
                <p class="fragment" style="text-align: left">&bull; Modular GPU-accelerated implementation</p>
                <p class="fragment" style="text-align: left">&bull; Reduced number of weights
                    <br>
                    &nbsp;&nbsp;&nbsp; &rArr; Direct inference of model parameters possible
                </p>
                <p class="fragment" style="text-align: left">&bull; Extension to mock galaxies catalogues possible</p>
            </section>
        </section>
        <section>
            <section data-transition="none" data-background-transition="none">
                <h4>Field-Level inference from Galaxy surveys with BORG</h4>
                <div data-transition="none" class="r-stack" style="position: relative">
                    <div>
                        <img class="fancy_img" src="assets/borg.png">
                        <div style="display: flex; align-items: center; font-size:50%; padding-top: 2em">
                            <div
                                    style="display: inline; width: 800px; text-align: left">
                                Jasche & Wandelt (2013),
                                Jasche, Leclercq & Wandelt (2015),<br>
                                Lavaux & Jasche (2016),
                                Jasche & Lavaux (2019)
                            </div>
                            <div
                                    style="display: inline; position: relative; left: 100px">Image credit: D.K Ramanah
                            </div>
                        </div>
                    </div>
                    <p class="fragment"
                       style="color: black; transform: rotate(-20deg); background-color: #e7e7e7; border-radius: 5px; position: relative; right: 160px; bottom: 42px">
                        &nbsp;$\texttt{PineTree}$&nbsp;</p>
                    <p class="fragment"
                       style="color: black; transform: rotate(-20deg); background-color: #e7e7e7; border-radius: 5px; position: relative; right: 160px; bottom: 42px">
                        &nbsp;Neural network&nbsp;</p>
                    <p class="fragment"
                       style="color: #FFD369; position: relative; top: 197px; right: 135px; font-size: 80%">
                        Parameter space is highly degenerate
                    </p>
                </div>
            </section>
            <section>
                <p  style="font-size: 1.2em">Can we pick better priors?</p>
            </section>
            <section data-auto-animate>
                <h3>physics informed priors from simulations</h3>
                <div style="display: flex; align-items: center">
                    <img class="fancy_img" style="position: relative; left: 100px" src="assets/quijote_dm.svg"
                         height="300">
                    <img class="fancy_img fragment" data-fragment-index="0" style="position: relative; right: 200px"
                         src="assets/quijote_pk_m.svg" height="300">
                    <span class="fragment" data-fragment-index="2"
                          style="position: relative; right: 177px">$$\div$$</span>
                    <img class="fancy_img" style="position: relative; right: 150px;" src="assets/quijote_dg.svg"
                         height="300">
                    <img class="fancy_img fragment" data-fragment-index="1" style="position: relative; right: 435px"
                         src="assets/quijote_pk_g.svg" height="300">
                    <span class="fragment" data-fragment-index="2" style="position: relative; right: 407px">$$=$$</span>
                    <img class="fancy_img fragment" data-fragment-index="2" style="position: relative; right: 380px;"
                         src="assets/quijote_ratios.svg" height="300">
                    <img class="fancy_img fragment" data-fragment-index="3" style="position: relative; right: 684px;"
                         src="assets/quijote_ratios_weird.svg" height="300">
                </div>
                <p class="fragment" data-fragment-index="4" style="padding-top: 1em; padding-bottom: 0.8em">&rArr; New constraint from
                    simulations <span style="color: #FFD369">$r = \frac{P_m(k)}{P_g(k)}$</span></p>
                <p class="fragment" data-fragment-index="5" style="text-align: left; font-size: 70%;">Note: Any summary statistic other than power spectrum may be used</p>
            </section>
            <section data-auto-animate>
                <h3>physics informed priors from simulations</h3>
                <p>
                    <span>Conditional independent constraint $r\,$</span>: &nbsp;&nbsp;<span
                        class="fragment">$P(\text{data}|r) = P(\text{data})$</span>
                </p>
                <div class="r-stack">
                    <p class="fragment">\[
                        \begin{aligned}
                        P(\theta|\text{data}, r) &amp; = \frac{P(\text{data}, r|\theta)P(\theta)}{P(\text{data})} \\
                        &amp; = \frac{P(\text{data}|\theta)}{P(\text{data})} \frac{P(r|\theta)P(\theta)}{P(r)} =
                        \frac{P(\text{data}|\theta)P(\theta|r)}{P(\text{data})} \\
                        &amp; \propto P(\text{data}|\theta)P(r|\theta)P(\theta) \phantom{\frac{P(\text{data},
                        r|\theta)P(\theta)}{P(\text{data})}}
                        \end{aligned}
                        \]
                    </p>
                    <div class="fragment fade-out"
                         style="background-color: #191919; width:1200px;height:3em; position: relative;"></div>
                    <div class="fragment fade-out"
                         style="background-color: #191919; width:800px;height:3em; position: relative; right: 0em; top: 3em;"></div>
                </div>
            </section>
            <section>
                <p style="font-size: 1.2em">
                    <b style="color: #FFD369">RO</b>bust <b style="color: #FFD369">B</b>ayesian <b
                        style="color: #FFD369">IN</b>ference with <b style="color: #FFD369">P</b>hysics-<b
                        style="color: #FFD369">i</b>nformed <b style="color: #FFD369">P</b>rior</p>
                <p style="font-size: 1.2em"><b>ROBIN-PiP</b></p>
                <p style="font-size: 70%;">with Ludvig Doeser (Stockholm University)</p>
            </section>
            <section data-transition="none" data-background-transition="none">
                <h4>Field-Level inference from Galaxy surveys with BORG</h4>
                <div data-transition="none" class="r-stack" style="position: relative">
                    <div>
                        <img class="fancy_img" src="assets/borg.png">
                        <div style="display: flex; align-items: center; font-size:50%; padding-top: 2em">
                            <div
                                    style="display: inline; width: 800px; text-align: left">
                                Jasche & Wandelt (2013),
                                Jasche, Leclercq & Wandelt (2015),<br>
                                Lavaux & Jasche (2016),
                                Jasche & Lavaux (2019)
                            </div>
                            <div
                                    style="display: inline; position: relative; left: 100px">Image credit: D.K Ramanah
                            </div>
                        </div>
                    </div>
                    <p class="fragment"
                       style="color: black; transform: rotate(-10deg); background-color: #e7e7e7; border-radius: 5px; position: relative; left: 320px; bottom: 172px">
                        &nbsp;Robin-PiP&nbsp;
                    </p>
                    <p
                            style="color: black; transform: rotate(-20deg); background-color: #e7e7e7; border-radius: 5px; position: relative; right: 160px; bottom: 42px">
                        &nbsp;Bias model&nbsp;</p>
                    <p
                            style="color: #FFD369;position: relative; top: 200px; right: 340px; font-size: 80%">
                        $\approx 2.1\times 10^6$ parameters
                    </p>
                    <p class="fragment"
                       style="color: #FFD369; position: relative; top: 200px; left: 260px; font-size: 80%">
                        Use self-consistent simulations & mock observables
                    </p>
                </div>
            </section>
            <section>
                <p><b>ROBIN-PiP $\times$ BORG</b></p>
                <div style="display: flex; align-items: center">
                    <div class="r-stack" style="position: relative; left: 120px">
                        <img class="fragment fancy_img" data-fragment-index="0" src="assets/quijote_dg_0.svg"
                             height="350">
                        <img class="fragment fancy_img" data-fragment-index="1" src="assets/quijote_dg_1.svg"
                             height="350">
                    </div>
                    <div class="r-stack" style="position: relative; left: 400px">
                        <img class="fragment fancy_img" data-fragment-index="3" src="assets/quijote_ratios_1.svg"
                             height="350">
                        <img class="fragment fancy_img" data-fragment-index="6" src="assets/quijote_ratios_2.svg"
                             height="350">
                    </div>
                </div>
                <span>
                    <p style="display: inline; position: relative; right: 170px" class="fragment"
                       data-fragment-index="2">Galaxy clustering log-likelihood</p>
                    <p style="display: inline; position: relative; right: 120px" class="fragment"
                       data-fragment-index="4">$+ $</p>
                    <p style="display: inline; position: relative; left: 50px"><span class="fragment" data-fragment-index="5">$w$</span> <span
                            class="fragment" data-fragment-index="4">Robin-PiP</span></p>
                </span>
            </section>
            <section>
                <img data-id="result" class="fancy_img" src="assets/robin_scheme.svg">
            </section>
            <section>
                <div class="r-stack">
                    <img class="fancy_img" src="assets/robin_borg_0.svg" height="650">
                    <img class="fancy_img fragment" src="assets/robin_borg_1.svg" height="650">
                </div>
            </section>
            <section>
                <img class="fancy_img" src="assets/cnn_sampling_comparison.png" height="670">
            </section>
            <section>
                <img class="fancy_img" src="assets/cnn_ratio_comparison.svg" height="384">
            </section>
            <section>
                <div class="r-stack">
                    <img class="fancy_img" src="assets/burn-in_wo_robin.png" width="1200">
                    <img class="fragment fancy_img" src="assets/burn-in_with_robin.png" width="1200">
                </div>
            </section>
        </section>
        <section>
            <h2>Summary</h2>
            <p style="text-align: left; font-size: 1.2em">Physics-informed neural bias $\texttt{PineTree}$</p>
            <ul style="text-align: left">
                <li>Reduce parameter space through e.g. symmetries</li>
                <li>Computationally efficient & differentiable</li>
                <li>Direct model parameter inference possible</li>
            </ul>
            <p style="text-align: left; font-size: 1.2em">Physics-informed priors $\texttt{Robin-PiP}$</p>
            <ul style="text-align: left">
                <li>Principled way of incorporating simulations into
                    inference</li>
                <li>Model agnostic</li>
                <li>Can robustify overparameterized models</li>
            </ul>
        </section>
        <section>
            <section>
                <h2>Back-up slides</h2>
            </section>
            <section>
                <h4>Log-Normal mixture network</h4>
                <p style="padding-bottom: 0">$$n_j\big(M|\boldsymbol{\psi_j}\big) = \frac{\bar{N}_j}{V} \sum_{i}^{N}
                    \frac{\alpha_{ij}}{M}
                    \mathcal{N}(\log M |\, \mu_{ij},\sigma_{ij})$$</p>
                <span>
                    <p style="text-align: left">$\bar{N}_j = \exp\left[\omega^{\bar{N}}\boldsymbol{\psi_j} + b^{\bar{N}} \right]$</p>
                    <p style="text-align: left">$\alpha_{ij} = \text{softmax}(w_i^\alpha\boldsymbol{\psi_j} + b_i^\alpha)$</p>
                    <p style="text-align: left">$\mu_{ij} = \begin{cases}
                        w_i^\mu\boldsymbol{\psi_j} + b_i^\mu &\text{if $i = 0$}\\
                        \text{max}\big[ w_i^\mu\boldsymbol{\psi_j} + b_i^\mu \big] + \mu_{i-1} &\text{if $ i > 0$}
                        \end{cases}$
                    </p>
                    <p style="text-align: left">$\sigma_{ij} = \exp\left[w_i^\sigma\boldsymbol{\psi_j} + b_i^\sigma\right]$</p>
                </span>
            </section>
            <section>
                <h4>Sampling</h4>
                <p style="padding-bottom: 1em">$n_j\big(M|\boldsymbol{\psi_j}\big) = \frac{\bar{N}_j}{V}
                    \mathcal{P}(M|\boldsymbol{\psi_j}, \boldsymbol{w}) = $ <span>$\frac{\bar{N}_j}{V} \sum_{i}^{N} \frac{\alpha_{ij}}{M}
                    \mathcal{N}(\log M |\, \mu_{ij},\sigma_{ij})$</span></p>
                <p>$\langle N_{\text{halo}}\rangle_j = \bar{N}_j$ is Poisson</p>
                <p style="padding-top: 1em">$N_j\curvearrowleft \mathcal{P}_{\rm Poiss.}(\lambda_j = \bar{N}_j)$ <span
                        class="fragment"> &xrarr; $\{M_j\} \curvearrowleft \sum_{i}^{N} \frac{\alpha_{ij}}{M} \mathcal{N}(\log M |\, \mu_{ij},\sigma_{ij})$</span>
                </p>
            </section>
        </section>
    </div>
</div>

<script src="reveal.js/dist/reveal.js"></script>
<script src="reveal.js/plugin/notes/notes.js"></script>
<script src="reveal.js/plugin/markdown/markdown.js"></script>
<script src="reveal.js/plugin/highlight/highlight.js"></script>
<script src="reveal.js/plugin/math/math.js"></script>
<script>
    // More info about initialization & config:
    // - https://revealjs.com/initialization/
    // - https://revealjs.com/config/
    Reveal.initialize({
        hash: true,
        width: 1200,
        height: 700,

        slideNumber: "c",
        controls: false,

        // Factor of the display size that should remain empty around
        // the content
        margin: 0.04,

        // Learn about plugins: https://revealjs.com/plugins/
        plugins: [RevealMarkdown, RevealHighlight, RevealNotes, RevealMath.MathJax3]
    });
</script>
</body>
</html>
